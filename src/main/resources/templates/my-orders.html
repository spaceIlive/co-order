<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header :: header}" />
<body>
<div class="container">
    <div th:replace="~{fragments/bodyHeader :: bodyHeader}"/>
    
    <div class="py-5">
        <h2 class="mb-4">ÎÇ¥ Ï£ºÎ¨∏</h2>
        
        <div th:if="${errorMessage}" class="alert alert-danger alert-dismissible fade show" role="alert">
            <span th:text="${errorMessage}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        
        <!-- Î™®ÏßëÏ§ë -->
        <div class="mb-5">
            <h3 class="mb-3">
                <span class="badge bg-primary">Î™®ÏßëÏ§ë</span>
            </h3>
            
            <div th:if="${openList != null and !openList.isEmpty()}">
                <div th:each="p : ${openList}" class="card mb-3 shadow-sm">
                    <div class="card-body">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h5 class="mb-2">
                                    <span class="badge bg-primary me-2">üè™</span>
                                    <span th:text="${p.post.store.name}"></span>
                                </h5>
                                <div class="d-flex gap-4">
                                    <span>
                                        <strong>üë• Ï∞∏Ïó¨Ïù∏Ïõê:</strong> 
                                        <span th:text="${p.post.currentParticipants}"></span>Î™Ö Ï∞∏Ïó¨ Ï§ë 
                                        <span class="text-muted">(ÏµúÏÜå <span th:text="${p.post.minParticipants}"></span>Î™Ö ÌïÑÏöî)</span>
                                    </span>
                                    <span>
                                        <strong>‚è∞ ÎßàÍ∞ê:</strong> 
                                        <span th:text="${#temporals.format(p.post.deadline, 'MM-dd HH:mm')}"></span>
                                    </span>
                                </div>
                            </div>
                            <div class="col-md-4 text-end">
                                <span class="badge bg-success fs-6 me-2">ÏßÑÌñâÏ§ë</span>
                                <form th:action="@{/participations/{participationId}/cancel(participationId=${p.id})}" 
                                      method="post" 
                                      style="display: inline;"
                                      onsubmit="return confirm('Ï†ïÎßê Ï∞∏Ïó¨Î•º Ï∑®ÏÜåÌïòÏãúÍ≤†ÏäµÎãàÍπå?');">
                                    <button type="submit" class="btn btn-danger btn-sm">Ï∑®ÏÜå</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div th:if="${openList == null or openList.isEmpty()}" class="alert alert-info">
                Î™®ÏßëÏ§ëÏù∏ Ï£ºÎ¨∏Ïù¥ ÏóÜÏäµÎãàÎã§.
            </div>
        </div>
        
        <!-- Î™®ÏßëÏôÑÎ£å -->
        <div class="mb-5">
            <h3 class="mb-3">
                <span class="badge bg-success">Î™®ÏßëÏôÑÎ£å</span>
            </h3>
            
            <div th:if="${completedList != null and !completedList.isEmpty()}">
                <div th:each="p : ${completedList}" class="card mb-3 shadow-sm">
                    <div class="card-body">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h5 class="mb-2">
                                    <span class="badge bg-success me-2">‚úì</span>
                                    <span th:text="${p.post.store.name}"></span>
                                </h5>
                                <div class="d-flex gap-4">
                                    <span>
                                        <strong>üë• Ï∞∏Ïó¨Ïù∏Ïõê:</strong> 
                                        <span th:text="${p.post.currentParticipants}"></span>Î™Ö Ï∞∏Ïó¨ Ï§ë 
                                        <span class="text-muted">(ÏµúÏÜå <span th:text="${p.post.minParticipants}"></span>Î™Ö ÌïÑÏöî)</span>
                                    </span>
                                    <span>
                                        <strong>‚è∞ ÎßàÍ∞ê:</strong> 
                                        <span th:text="${#temporals.format(p.post.deadline, 'MM-dd HH:mm')}"></span>
                                    </span>
                                </div>
                            </div>
                            <div class="col-md-4 text-end">
                                <span th:if="${p.post.status.name() == 'ORDERED'}" 
                                      class="badge bg-success fs-6">Ï£ºÎ¨∏ÏôÑÎ£å</span>
                                <span th:if="${p.post.status.name() == 'WAITING_ORDER'}" 
                                      class="badge bg-warning fs-6">Ï£ºÎ¨∏ÎåÄÍ∏∞</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div th:if="${completedList == null or completedList.isEmpty()}" class="alert alert-info">
                ÏôÑÎ£åÎêú Ï£ºÎ¨∏Ïù¥ ÏóÜÏäµÎãàÎã§.
            </div>
        </div>
        
        <!-- Ï∑®ÏÜåÎê® (Ï†ëÏñ¥ÎëêÍ∏∞) -->
        <div class="mb-5">
            <details>
                <summary class="text-muted small" style="cursor: pointer;">
                    <span class="badge bg-secondary">Ï∑®ÏÜåÎêú Ï£ºÎ¨∏ Î≥¥Í∏∞</span>
                    (<span th:text="${cancelledList != null ? cancelledList.size() : 0}"></span>Í±¥)
                </summary>
                
                <div class="mt-3">
                    <div th:if="${cancelledList != null and !cancelledList.isEmpty()}">
                        <div th:each="p : ${cancelledList}" class="card mb-2 bg-light">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col-md-10">
                                        <h6 class="mb-1 text-muted">
                                            <span th:text="${p.post.store.name}"></span>
                                        </h6>
                                        <small class="text-muted">
                                            ÎßàÍ∞ê: <span th:text="${#temporals.format(p.post.deadline, 'MM-dd HH:mm')}"></span>
                                        </small>
                                    </div>
                                    <div class="col-md-2 text-end">
                                        <span class="badge bg-secondary">Ï∑®ÏÜå</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div th:if="${cancelledList == null or cancelledList.isEmpty()}" class="text-muted small">
                        Ï∑®ÏÜåÎêú Ï£ºÎ¨∏Ïù¥ ÏóÜÏäµÎãàÎã§.
                    </div>
                </div>
            </details>
        </div>
    </div>
    
    <div th:replace="~{fragments/footer :: footer}" />
</div>

<script th:src="@{/js/bootstrap.bundle.min.js}"></script>
</body>
</html>

